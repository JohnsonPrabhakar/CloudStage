
{
  "rules": {
    "match /databases/{database}/documents": {
      "function isAdmin()": {
        "return": "request.auth != null && request.auth.token.email == 'admin@cloudstage.in';"
      },
      "match /events/{eventId}": {
        "allow read, write: if isAdmin();",
        "allow read": "if resource.data.moderationStatus == 'approved' || (request.auth != null && resource.data.artistId == request.auth.uid);",
        "allow create": "if request.auth != null && request.resource.data.artistId == request.auth.uid;",
        "allow update": "if (request.auth != null && resource.data.artistId == request.auth.uid && !('moderationStatus' in request.resource.data));",

        "match /messages/{messageId}": {
          "allow read": "if true;",
          "allow create": "if request.auth != null;"
        }
      },
      "match /artists/{artistId}": {
        "allow read, write: if isAdmin();",
        "allow read": "if true;",
        "allow create": "if request.auth != null && artistId == request.auth.uid;",
        "allow update": "if (request.auth != null && request.auth.uid == artistId);",
        "match /followers/{userId}": {
          "allow read": "if true;",
          "allow write": "if request.auth != null && request.auth.uid == userId;"
        }
      },
      "match /tickets/{ticketId}": {
        "allow read, write: if isAdmin();",
        "allow read": "if (request.auth != null && resource.data.userId == request.auth.uid);",
        "allow create": "if request.auth != null && request.resource.data.userId == request.auth.uid;",
        "allow update, delete": "if false;"
      },
      "match /movies/{movieId}": {
        "allow read, write: if isAdmin();",
        "allow read": "if true;"
      },
      "match /config/{docId}": {
        "allow read": "if true;",
        "allow write": "if isAdmin();"
      },
      "match /eventFeedback/{feedbackId}": {
         "allow create": "if request.auth != null && request.resource.data.userId == request.auth.uid;"
      },
       "match /users/{userId}": {
        "allow read, write: if isAdmin();",
        "allow read": "if request.auth != null && request.auth.uid == userId;",
        "allow create": "if request.auth != null && request.auth.uid == userId;",
        "allow update": "if request.auth != null && request.auth.uid == userId;"
      }
    }
  }
}
