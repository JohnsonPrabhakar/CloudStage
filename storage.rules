
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // Allow public read access for all files so that images and videos
    // can be displayed to all users.
    match /{allPaths=**} {
      allow read;
    }

    // Allow artists to write only to their own directories. This covers
    // profile pictures, verification samples, and event banners.
    match /artists/{artistId}/{allPaths=**} {
      allow write: if request.auth != null && request.auth.uid == artistId;
    }

    // Allow any authenticated user to write to the movies path.
    // This relies on the client-side check that already gatekeeps the
    // upload form for admins.
    match /movies/{movieId}/{allPaths=**} {
      allow write: if request.auth != null;
    }
  }
}
